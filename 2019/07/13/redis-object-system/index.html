<!DOCTYPE html>












  


<html class="theme-next mist use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=6.5.0" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.5.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.5.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.5.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.5.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '6.5.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="Redis是一个key-value类型的数据库，key可以是整数或者字符串，value可以支持丰富的数据结构，如字符串、列表、哈希、集合及有序集合。在Redis中，对这些数据结构统一进行了封装，都是以redis对象(redisObject)来呈现，这篇文章主要是对redisObect内部原理及实现做一些梳理，内容主要基于《Redis设计与实现》。 1. 对象定义在Redis中对象的定义如下：123">
<meta name="keywords" content="redis,redisObject,空转时长">
<meta property="og:type" content="article">
<meta property="og:title" content="Redis 对象系统">
<meta property="og:url" content="http://yoursite.com/2019/07/13/redis-object-system/index.html">
<meta property="og:site_name" content="以太格">
<meta property="og:description" content="Redis是一个key-value类型的数据库，key可以是整数或者字符串，value可以支持丰富的数据结构，如字符串、列表、哈希、集合及有序集合。在Redis中，对这些数据结构统一进行了封装，都是以redis对象(redisObject)来呈现，这篇文章主要是对redisObect内部原理及实现做一些梳理，内容主要基于《Redis设计与实现》。 1. 对象定义在Redis中对象的定义如下：123">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://yoursite.com/images/string-int.jpg">
<meta property="og:image" content="http://yoursite.com/images/string-raw.jpg">
<meta property="og:image" content="http://yoursite.com/images/string-embstr.jpg">
<meta property="og:image" content="http://yoursite.com/images/redis-server.jpg">
<meta property="og:image" content="http://yoursite.com/images/dict-node.jpg">
<meta property="og:image" content="http://yoursite.com/images/redis-object.jpg">
<meta property="og:image" content="http://yoursite.com/images/dictEntry.jpg">
<meta property="og:updated_time" content="2021-07-31T09:17:10.688Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Redis 对象系统">
<meta name="twitter:description" content="Redis是一个key-value类型的数据库，key可以是整数或者字符串，value可以支持丰富的数据结构，如字符串、列表、哈希、集合及有序集合。在Redis中，对这些数据结构统一进行了封装，都是以redis对象(redisObject)来呈现，这篇文章主要是对redisObect内部原理及实现做一些梳理，内容主要基于《Redis设计与实现》。 1. 对象定义在Redis中对象的定义如下：123">
<meta name="twitter:image" content="http://yoursite.com/images/string-int.jpg">






  <link rel="canonical" href="http://yoursite.com/2019/07/13/redis-object-system/">



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Redis 对象系统 | 以太格</title>
  











  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">以太格</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-commonweal">

    
    
    
      
    

    

    <a href="/404/" rel="section"><i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br>公益 404</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>关于我</a>

  </li>

      
      
    </ul>
  

  
    

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/13/redis-object-system/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Noahsark">
      <meta itemprop="description" content="不畏将来，不念过往">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="以太格">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Redis 对象系统
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-07-13 13:29:41" itemprop="dateCreated datePublished" datetime="2019-07-13T13:29:41+08:00">2019-07-13</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2021-07-31 17:17:10" itemprop="dateModified" datetime="2021-07-31T17:17:10+08:00">2021-07-31</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/redis/" itemprop="url" rel="index"><span itemprop="name">redis</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-symbolscount">
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">本文字数：</span>
                
                <span title="本文字数">16k</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">14 分钟</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>Redis是一个key-value类型的数据库，key可以是整数或者字符串，value可以支持丰富的数据结构，如字符串、列表、哈希、集合及有序集合。在Redis中，对这些数据结构统一进行了封装，都是以redis对象(redisObject)来呈现，这篇文章主要是对redisObect内部原理及实现做一些梳理，内容主要基于《Redis设计与实现》。</p>
<h2 id="1-对象定义"><a href="#1-对象定义" class="headerlink" title="1. 对象定义"></a>1. 对象定义</h2><p>在Redis中对象的定义如下：<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">redisObject</span> &#123;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 类型</span></span><br><span class="line">    <span class="keyword">unsigned</span> type:<span class="number">4</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 编码</span></span><br><span class="line">    <span class="keyword">unsigned</span> encoding:<span class="number">4</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 指向底层的数据结构</span></span><br><span class="line">    <span class="keyword">void</span> *ptr;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 引用计数</span></span><br><span class="line">    <span class="keyword">int</span> refcount;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 最后一次程序访问的时间</span></span><br><span class="line">    <span class="keyword">unsigned</span> lru:<span class="number">22</span></span><br><span class="line"></span><br><span class="line">&#125; robj;</span><br></pre></td></tr></table></figure></p>
<h3 id="1-1-类型"><a href="#1-1-类型" class="headerlink" title="1.1 类型"></a>1.1 类型</h3><p>type属性记录了对象的类型，有五种对象类型，分别是字符串对象、列表对象、哈希对象、集合对象和有序集合对象,可以在键上使用TYPE命令查看键的类型，如果一个键是字符串类型，用命令查看如下所示:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">redis&gt; TYPE msg</span><br><span class="line">string</span><br></pre></td></tr></table></figure>
<p>type属性的值及命令输出对应如下表所示：</p>
<table>
<thead>
<tr>
<th>对象</th>
<th>type属性对应的值</th>
<th>TYPE命令输出</th>
</tr>
</thead>
<tbody>
<tr>
<td>字符串对象</td>
<td>REDIS_STRING</td>
<td>string</td>
</tr>
<tr>
<td>列表对象</td>
<td>REDIS_LIST</td>
<td>list</td>
</tr>
<tr>
<td>哈希对象</td>
<td>REDIS_HASH</td>
<td>hash</td>
</tr>
<tr>
<td>集合对象</td>
<td>REDIS_SET</td>
<td>set</td>
</tr>
<tr>
<td>有序集合对象</td>
<td>REDIS_ZSET</td>
<td>zset</td>
</tr>
</tbody>
</table>
<h3 id="1-2-编码和实现"><a href="#1-2-编码和实现" class="headerlink" title="1.2 编码和实现"></a>1.2 编码和实现</h3><p>对于一种对象，根据不同的使用场景可以有不同的底层数据结构来实现，不同的实现由encoding属性来表示，可以使用OBJECT ENCODING命令查看一个键值对值的编码，如果一个值是REDIS_ENCODING_EMBSTR，其输出如下所示：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">redis&gt; OBJECT ENCODING msg</span><br><span class="line"><span class="string">"embstr"</span></span><br></pre></td></tr></table></figure></p>
<p>encoding取值范围及代表的数据结构如下所示：</p>
<table>
<thead>
<tr>
<th>encoding取值范围</th>
<th>代表的数据结构</th>
<th>OBJECT ENCODING命令输出</th>
</tr>
</thead>
<tbody>
<tr>
<td>REDIS_ENCODING_INT</td>
<td>long类型的整数</td>
<td>int</td>
</tr>
<tr>
<td>REDIS_ENCODING_EMBSTR</td>
<td>embstr编码的简单的动态字符串</td>
<td>embstr</td>
</tr>
<tr>
<td>REDIS_ENCODING_RAW</td>
<td>简单动态字符串</td>
<td>raw</td>
</tr>
<tr>
<td>REDIS_ENCODING_HT</td>
<td>字典</td>
<td>hashtable</td>
</tr>
<tr>
<td>REDIS_ENCODING_LINKEDLIST</td>
<td>双向链表</td>
<td>linkedlist</td>
</tr>
<tr>
<td>REDIS_ENCODING_ZIPLIST</td>
<td>压缩列表</td>
<td>ziplist</td>
</tr>
<tr>
<td>REDIS_ENCODING_INTSET</td>
<td>整数集合</td>
<td>intset</td>
</tr>
<tr>
<td>REDIS_ENCODING_SKIPLIST</td>
<td>跳跃表和字典</td>
<td>skiplist</td>
</tr>
</tbody>
</table>
<p>在Redis中有五种对象，每一种对象根据不同的使用场景可以有不同的数据结构来实现，类型type和编码encoding的关系对应如下表所示：</p>
<table>
<thead>
<tr>
<th>type</th>
<th>encoding</th>
<th>对象</th>
</tr>
</thead>
<tbody>
<tr>
<td>REDIS_STRING</td>
<td>REDIS_ENCODING_INT</td>
<td>使用整数值实现的字符串对象</td>
</tr>
<tr>
<td>REDIS_STRING</td>
<td>REDIS_ENCODING_EMBSTR</td>
<td>使用embstr编码实现的SDS字符串对象</td>
</tr>
<tr>
<td>REDIS_STRING</td>
<td>REDIS_ENCODING_RAW</td>
<td>SDS字符串对象</td>
</tr>
<tr>
<td>REDIS_LIST</td>
<td>REDIS_ENCODING_LINKEDLIST</td>
<td>使用双向链表实现的列表对象</td>
</tr>
<tr>
<td>REDIS_LIST</td>
<td>REDIS_ENCODING_ZIPLIST</td>
<td>使用压缩列表实现的列表对象</td>
</tr>
<tr>
<td>REDIS_HASH</td>
<td>REDIS_ENCODING_HT</td>
<td>使用字典实现的哈希对象</td>
</tr>
<tr>
<td>REDIS_HASH</td>
<td>REDIS_ENCODING_ZIPLIST</td>
<td>使用压缩列表实现的哈希对象</td>
</tr>
<tr>
<td>REDIS_SET</td>
<td>REDIS_ENCODING_INTSET</td>
<td>使用整数集合实现的集合对象</td>
</tr>
<tr>
<td>REDIS_SET</td>
<td>REDIS_ENCODING_HT</td>
<td>使用字典实现的集合对象</td>
</tr>
<tr>
<td>REDIS_ZSET</td>
<td>REDIS_ENCODING_ZIPLIST</td>
<td>使用压缩列表实现的有序集合对象</td>
</tr>
<tr>
<td>REDIS_ZSET</td>
<td>REDIS_ENCODING_SKIPLIST</td>
<td>使用跳跃表和字典实现的有序集合对象</td>
</tr>
</tbody>
</table>
<h3 id="1-3-引用计数"><a href="#1-3-引用计数" class="headerlink" title="1.3 引用计数"></a>1.3 引用计数</h3><p>Redis在对象系统中构建了一个基于引用计数的内存回收机制，通过这个机制，在每一个对象的refcount属性中记录引用计数信息，Redis可以通过跟踪对象的这些引用计数信息，在适当的时候自动释放对象并进行内存回收。<br>对象的引用计数信息会随着对象的使用状态而不断变化：</p>
<ul>
<li>在创建一个新对象时，引用计数的值会被初始化为1；</li>
<li>当一个对象被引用时，它的引用计数值为加1；</li>
<li>当一个对象被解除引用时，它的引用计数值为减1；</li>
<li>当对象的引用计数值变为0时，对象会被释放。</li>
</ul>
<p>可以使用OBJECT REFCOUNT命令查看一个键对应的值被引用的次数，如下所示：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">redis&gt; OBJECT REFCOUNT key</span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br></pre></td></tr></table></figure></p>
<h3 id="1-4-对象的空转时长"><a href="#1-4-对象的空转时长" class="headerlink" title="1.4 对象的空转时长"></a>1.4 对象的空转时长</h3><p>redisObject中的lru属性记录了该对象最后一次被访问的时间，可以使用OBJECT IDLETIME命令打印给定键的空转时长，这个空转时长是通过当前时间减去键的值对象的lru时间计算出来的，单位为钞（S），命令如下所示：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">redis&gt; OBJECT IDLETIME msg</span><br><span class="line">(<span class="built_in">integer</span>) 10</span><br></pre></td></tr></table></figure></p>
<p>键的空转时长还有另外一个作用：如果Redis打开了maxmemory选项，并且服务器内存回收算法为volatile-lru或allkeys-lru，那么当服务器占用的内存超过了maxmemory选项所设置的上限值时，空转时长较高的那部分键会被优先释放，从而回收内存。</p>
<h2 id="2-字符串对象"><a href="#2-字符串对象" class="headerlink" title="2. 字符串对象"></a>2. 字符串对象</h2><p>字符串对象的编码可以是int、embstr或者raw。</p>
<h3 id="2-1-int编码的字符串"><a href="#2-1-int编码的字符串" class="headerlink" title="2.1 int编码的字符串"></a>2.1 int编码的字符串</h3><p>如果一个字符串对象保存的是整数值，并且这个整数值可以用long类型来表示，那么字符串对象中的ptr将指向一个long类型的地址，如下图所示：<br><img src="/images/string-int.jpg" alt="string-int" title="string-int"></p>
<h3 id="2-2-raw编码的字符串"><a href="#2-2-raw编码的字符串" class="headerlink" title="2.2 raw编码的字符串"></a>2.2 raw编码的字符串</h3><p>如果字符串对象保存的是一个字符串值，并且这个字符串值的长度大于39个字节，那么字符串对象将使用简单字符串（SDS）来保存这个字符串值，如下图所示：<br><img src="/images/string-raw.jpg" alt="string-raw" title="string-raw"></p>
<h3 id="2-3-embstr编码的字符串"><a href="#2-3-embstr编码的字符串" class="headerlink" title="2.3 embstr编码的字符串"></a>2.3 embstr编码的字符串</h3><p>如果字符串对象保存的是一个字符串值，并且这个字符串值的长度小于等于39个字节，那么字符串对象将使用embstr编码的方式保存这个字符串值。<br>embstr编码是专门用于保存短字符串的一种优化编码方式，这种编码和raw编码都使用sdshdr结构来保存字符串，区别主要在于内存分配：embstr编码会将redisobject和sdshdr作为一个整体，一次性分配相邻的空间来保存这两个对象，而raw编码则使用两次。embstr编码的内存结构如下所示：<br><img src="/images/string-embstr.jpg" alt="string-embstr" title="string-embstr"></p>
<h3 id="2-4-double类型的字符串"><a href="#2-4-double类型的字符串" class="headerlink" title="2.4 double类型的字符串"></a>2.4 double类型的字符串</h3><p>double类型的浮点数在Redis中是作为字符串保存的。如果要保存一个浮点数到字符串对象里面，Redis首先将这个浮点数转换成字符串，然后再保存到字符串对象中，编码可以是embstr或者raw。</p>
<h3 id="2-5-编码转换"><a href="#2-5-编码转换" class="headerlink" title="2.5 编码转换"></a>2.5 编码转换</h3><p>int编码的字符串对象和embstr编码的字符串对象在条件满足的情况下，会被转换为raw编码的字符串对象。</p>
<h4 id="2-5-1-int–-gt-raw"><a href="#2-5-1-int–-gt-raw" class="headerlink" title="2.5.1 int–&gt;raw"></a>2.5.1 int–&gt;raw</h4><p>如果对int编码的字符串对象执行了一些命令，使得这个对象保存的不再是整数值，而是一个字符串，那么字符串对象的编码将从int变为raw。</p>
<h4 id="2-5-2-ebmstr–-gt-raw"><a href="#2-5-2-ebmstr–-gt-raw" class="headerlink" title="2.5.2 ebmstr–&gt;raw"></a>2.5.2 ebmstr–&gt;raw</h4><p>ebmstr编码的字符串对象是只读的，如果要对该对象进行修改操作，则会将embstr编码的字符串对象转换为raw编码的字符串对象。</p>
<h2 id="3-列表对象"><a href="#3-列表对象" class="headerlink" title="3. 列表对象"></a>3. 列表对象</h2><p>列表对象的编码可以是ziplist或者linkedlist。</p>
<h3 id="3-1-ziplist编码的列表对象"><a href="#3-1-ziplist编码的列表对象" class="headerlink" title="3.1 ziplist编码的列表对象"></a>3.1 ziplist编码的列表对象</h3><p>ziplist编码的列表对象使用压缩列表作为底层实现，每一个压缩列表结点（entry）保存了一个列表对象。</p>
<h3 id="3-2-linkedlist编码的列表对象"><a href="#3-2-linkedlist编码的列表对象" class="headerlink" title="3.2 linkedlist编码的列表对象"></a>3.2 linkedlist编码的列表对象</h3><p>linkedlist编码的列表对象使用双向链表作为底层实现，每一个双向链表结点（node）都保存了一个字符串对象，而每一个字符串对象都保存了一个列表元素。</p>
<h3 id="3-3-编码转换"><a href="#3-3-编码转换" class="headerlink" title="3.3 编码转换"></a>3.3 编码转换</h3><p>当列表对象同时满足以下两个条件时，列表对象使用ziplist编码：</p>
<ol>
<li>列表对象保存的所有字符串元素的长度都小于64字节；</li>
<li>列表对象保存的元素数量小于512个。</li>
</ol>
<p>不能满足这两个条件的列表对象需要使用linkedlist编码。</p>
<p><strong>注：list-max-ziplist-value和list-max-ziplist-entries两个选项可以修改上面两个值。</strong></p>
<p>对于使用ziplist编码的列表对象来说，当使用ziplist编码所需的两个条件的任意一个不能被满足时，就会进行编码的转换，将ziplist转换为linkedlist。</p>
<h2 id="4-哈希对象"><a href="#4-哈希对象" class="headerlink" title="4. 哈希对象"></a>4. 哈希对象</h2><p>哈希对象的编码可以是ziplist或者hashtable。</p>
<h3 id="4-1-ziplist编码的哈希对象"><a href="#4-1-ziplist编码的哈希对象" class="headerlink" title="4.1 ziplist编码的哈希对象"></a>4.1 ziplist编码的哈希对象</h3><p>ziplist编码的哈希对象使用压缩列表作为底层实现，每当有新的键值对加入到哈希对象时，Redis依次将键结点、值结点推入到压缩列表表尾。</p>
<h3 id="4-2-hashtable编码的哈希对象"><a href="#4-2-hashtable编码的哈希对象" class="headerlink" title="4.2 hashtable编码的哈希对象"></a>4.2 hashtable编码的哈希对象</h3><p>hashtable编码的哈希对象使用字典作为底层实现，哈希对象的键值都分别是一个字符串对象。</p>
<h3 id="4-3-编码转换"><a href="#4-3-编码转换" class="headerlink" title="4.3 编码转换"></a>4.3 编码转换</h3><p>当哈希对象同时满足以下条件时，哈希对象使用ziplist编码：</p>
<ol>
<li>哈希对象保存的所有键值的字符串长度长度都小于64字节；</li>
<li>哈希对象保存的键值对数量小于512个。</li>
</ol>
<p>不能满足这两个条件的哈希对象需要使hashtable编码。</p>
<p><strong>注：hash-max-ziplist-value和hash-max-ziplist-entries两个选项可以修改上面两个值。</strong></p>
<p>对于使用ziplist编码的哈希对象来说，当使用ziplist编码所需的两个条件的任意一个不能被满足时，就会进行编码的转换，将ziplist转换为hashtable。</p>
<h2 id="5-集合对象"><a href="#5-集合对象" class="headerlink" title="5. 集合对象"></a>5. 集合对象</h2><p>集合对象的编码可以是intset或者hashtable。</p>
<h3 id="5-1-intset编码的集合对象"><a href="#5-1-intset编码的集合对象" class="headerlink" title="5.1 intset编码的集合对象"></a>5.1 intset编码的集合对象</h3><p>intset编码的集合对象使用整数集合作为底层实现，集合对象包含的所有元素都是整数。</p>
<h3 id="5-2-hashtable编码的集合对象"><a href="#5-2-hashtable编码的集合对象" class="headerlink" title="5.2 hashtable编码的集合对象"></a>5.2 hashtable编码的集合对象</h3><p>hashtable编码的集合对象使用字典作为底层实现，字典的每一个键都是一个字符串对象，保存了集合元素，而字典的值全部设置为NULL。</p>
<h3 id="5-3-编码转换"><a href="#5-3-编码转换" class="headerlink" title="5.3 编码转换"></a>5.3 编码转换</h3><p>当集合对象同时满足以下条件时，集合对象使用intset编码：</p>
<ol>
<li>集合对象保存的所有元素都是整数值；</li>
<li>集合对象保存的元素数量小于512个。</li>
</ol>
<p>不能满足这两个条件的集合对象需要使hashtable编码。</p>
<p><strong>注：第二个条件是要可以通过set-max-intset-entries选项进行修改。</strong></p>
<p>对于使用intset编码的集合对象来说，当使用intset编码所需的两个条件的任意一个不能被满足时，就会进行编码的转换，将intset转换为hashtable。</p>
<h2 id="6-有序集合对象"><a href="#6-有序集合对象" class="headerlink" title="6. 有序集合对象"></a>6. 有序集合对象</h2><p>有序集合的编码可以是ziplist或者skiplist。</p>
<h3 id="6-1-ziplist编码的有序集合对象"><a href="#6-1-ziplist编码的有序集合对象" class="headerlink" title="6.1 ziplist编码的有序集合对象"></a>6.1 ziplist编码的有序集合对象</h3><p>ziplist编码的有序集合对象使用压缩列表作为底层实现，每个集合元素使用两个紧挨在一起的压缩列表结点来保存，第一个结点保存元素的成员（member），第二个结点则保存元素的分值（score）。<br>压缩列表的集合元素按分值从小到大进行排序，分值较小的元素被放置在靠近表头的位置，而分值较大的元素则被放置表尾的位置。</p>
<h3 id="6-2-skiplist编码的有序集合对象"><a href="#6-2-skiplist编码的有序集合对象" class="headerlink" title="6.2 skiplist编码的有序集合对象"></a>6.2 skiplist编码的有序集合对象</h3><p>skiplis编码的有序集合对象使用zset结构来作为底层实现，一个zset结构同时包含一个字典和一个跳跃表，其结构如下所示：<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">zset</span> &#123;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 跳跃表</span></span><br><span class="line">    zskiplist *zsl;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 字典</span></span><br><span class="line">    dict *dict;</span><br><span class="line">&#125; zset;</span><br></pre></td></tr></table></figure></p>
<p>zset结构中的zsl跳跃表按分值从小到大保存了所有集合元素，每个跳跃表结点保存了一个集合元素：object属性保存了元素的成员，score保存了元素的分值；<br>zset结构中的dict字典为有序集合创建一个成员到分值的映射，字典中的每个键值对保存了一个元素：字典的键保存了元素的成员，而字典的值则保存了分值。</p>
<p>使用跳跃表和字典来实现有序集合，可以充分两者的优点：</p>
<ol>
<li>通过跳跃表，可以O(NlogN)时间复杂度的范围查询；</li>
<li>通过字典，可以O(1)时间复杂度的查找元素成员。</li>
</ol>
<h3 id="6-3-编码转换"><a href="#6-3-编码转换" class="headerlink" title="6.3 编码转换"></a>6.3 编码转换</h3><p>当有序集合对象同时满足以下条件时，集合对象使用ziplist编码：</p>
<ol>
<li>有序集合对象保存的元素数量小于128个；</li>
<li>有序集合对象保存的所有元素的长度都小于64个字节。</li>
</ol>
<p>不能满足这两个条件的有序集合对象需要使skiplist编码。</p>
<p><strong>注：zset-max-ziplist-value和zset-max-ziplist-entries两个选项可以修改上面两个值。</strong></p>
<p>对于使用ziplist编码的有序集合对象来说，当使用ziplist编码所需的两个条件的任意一个不能被满足时，就会进行编码的转换，将ziplist转换为skiplist。</p>
<h2 id="7-字符串和整数"><a href="#7-字符串和整数" class="headerlink" title="7. 字符串和整数"></a>7. 字符串和整数</h2><p>Redis作为一个键值对数据库，构建了五种对象类型，原始类型如字符串和整数和对象类型的关系如下：</p>
<ol>
<li>字符串和整数存放在字符串对象，整数集合和压缩列表中；</li>
<li>在列表对象（linkedlist）、哈希对象（hashtable）和集合对象（hashtable）和有序集合对象（skiplist）中不直接存储字符串和整数，而是存储字符串对象。</li>
</ol>
<h2 id="8-Redis存储效率"><a href="#8-Redis存储效率" class="headerlink" title="8. Redis存储效率"></a>8. Redis存储效率</h2><p>Redis数据库的整体结构如下图所示，为了方便描述，将字符串对象、哈希对象及列表对象进行的简化。</p>
<p><img src="/images/redis-server.jpg" alt="redis-server" title="redis-server"></p>
<p>一个Redis服务器默认有16个数据库（DB），每个DB实际就是一个键值数据库，底层的数据结构是字典（dict），所有的数据都以键值对存储在dict中，其中键是一个字符串对象，而值可以是五种Redis对象中任意一种，即字符串对象、列表对象、哈希对象、集合对象及有序集合对象。</p>
<p>下面以一个字符串键值对为例来分析Redis的存储效率，即有效存储空间与所占空间的比率：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis&gt; SET message <span class="string">"Hello Redis"</span></span><br></pre></td></tr></table></figure></p>
<p>根据上图所示，增加一个新的字符串键值对需要增加如下对象：</p>
<ol>
<li>两个字符串对象；</li>
<li>一个字典结点对象，message及值就存储在这个结点中。</li>
</ol>
<p>如下图所示：</p>
<p><img src="/images/dict-node.jpg" alt="dict-node" title="dict-node"></p>
<h3 id="8-1-字符串对象"><a href="#8-1-字符串对象" class="headerlink" title="8.1 字符串对象"></a>8.1 字符串对象</h3><p>字符串对象的内存结构如下所示：</p>
<p><img src="/images/redis-object.jpg" alt="redis-object" title="redis-object"></p>
<p>message字符串对象：12 + 12 + 7 + 1 = 32字节</p>
<p>值对象：12 + 12 + 11 + 1 = 36字节</p>
<p>其中前两个12字节分别是redisObject和sdshdr结构体所占的空间，而最后1字节是’\0’空字符。</p>
<h3 id="8-2-字典结点对象"><a href="#8-2-字典结点对象" class="headerlink" title="8.2 字典结点对象"></a>8.2 字典结点对象</h3><p>字典结点对象的内存结构如下所示：</p>
<p><img src="/images/dictEntry.jpg" alt="dictEntry" title="dictEntry"></p>
<p>dictEntry：4 + 4 + 4 = 12字节</p>
<h3 id="8-3-存储效率"><a href="#8-3-存储效率" class="headerlink" title="8.3 存储效率"></a>8.3 存储效率</h3><p>存储一个字符串键值对需要额外的空间为：25 + 25 + 12 = 62字节<br>存储效率：(7 + 11) / (7 + 11 + 62) = 22.5%</p>
<p><strong>参考：</strong></p>
<hr>
<p>1.Redis设计与实现</p>

      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/redis/" rel="tag"># redis</a>
          
            <a href="/tags/redisObject/" rel="tag"># redisObject</a>
          
            <a href="/tags/空转时长/" rel="tag"># 空转时长</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/07/07/redis-data-structure/" rel="next" title="Redis 数据结构">
                <i class="fa fa-chevron-left"></i> Redis 数据结构
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/07/20/memcached-memory-model/" rel="prev" title="Memcached 内存模型">
                Memcached 内存模型 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Noahsark</p>
              <p class="site-description motion-element" itemprop="description">不畏将来，不念过往</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">50</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">21</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">164</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          

          

          

          
          

          
            
          
          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-对象定义"><span class="nav-number">1.</span> <span class="nav-text">1. 对象定义</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-类型"><span class="nav-number">1.1.</span> <span class="nav-text">1.1 类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-编码和实现"><span class="nav-number">1.2.</span> <span class="nav-text">1.2 编码和实现</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-引用计数"><span class="nav-number">1.3.</span> <span class="nav-text">1.3 引用计数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-4-对象的空转时长"><span class="nav-number">1.4.</span> <span class="nav-text">1.4 对象的空转时长</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-字符串对象"><span class="nav-number">2.</span> <span class="nav-text">2. 字符串对象</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-int编码的字符串"><span class="nav-number">2.1.</span> <span class="nav-text">2.1 int编码的字符串</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-raw编码的字符串"><span class="nav-number">2.2.</span> <span class="nav-text">2.2 raw编码的字符串</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-embstr编码的字符串"><span class="nav-number">2.3.</span> <span class="nav-text">2.3 embstr编码的字符串</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-4-double类型的字符串"><span class="nav-number">2.4.</span> <span class="nav-text">2.4 double类型的字符串</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-5-编码转换"><span class="nav-number">2.5.</span> <span class="nav-text">2.5 编码转换</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-5-1-int–-gt-raw"><span class="nav-number">2.5.1.</span> <span class="nav-text">2.5.1 int–&gt;raw</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-5-2-ebmstr–-gt-raw"><span class="nav-number">2.5.2.</span> <span class="nav-text">2.5.2 ebmstr–&gt;raw</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-列表对象"><span class="nav-number">3.</span> <span class="nav-text">3. 列表对象</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-ziplist编码的列表对象"><span class="nav-number">3.1.</span> <span class="nav-text">3.1 ziplist编码的列表对象</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-linkedlist编码的列表对象"><span class="nav-number">3.2.</span> <span class="nav-text">3.2 linkedlist编码的列表对象</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-编码转换"><span class="nav-number">3.3.</span> <span class="nav-text">3.3 编码转换</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-哈希对象"><span class="nav-number">4.</span> <span class="nav-text">4. 哈希对象</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-ziplist编码的哈希对象"><span class="nav-number">4.1.</span> <span class="nav-text">4.1 ziplist编码的哈希对象</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-hashtable编码的哈希对象"><span class="nav-number">4.2.</span> <span class="nav-text">4.2 hashtable编码的哈希对象</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-编码转换"><span class="nav-number">4.3.</span> <span class="nav-text">4.3 编码转换</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-集合对象"><span class="nav-number">5.</span> <span class="nav-text">5. 集合对象</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#5-1-intset编码的集合对象"><span class="nav-number">5.1.</span> <span class="nav-text">5.1 intset编码的集合对象</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-2-hashtable编码的集合对象"><span class="nav-number">5.2.</span> <span class="nav-text">5.2 hashtable编码的集合对象</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-3-编码转换"><span class="nav-number">5.3.</span> <span class="nav-text">5.3 编码转换</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-有序集合对象"><span class="nav-number">6.</span> <span class="nav-text">6. 有序集合对象</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#6-1-ziplist编码的有序集合对象"><span class="nav-number">6.1.</span> <span class="nav-text">6.1 ziplist编码的有序集合对象</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-2-skiplist编码的有序集合对象"><span class="nav-number">6.2.</span> <span class="nav-text">6.2 skiplist编码的有序集合对象</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-3-编码转换"><span class="nav-number">6.3.</span> <span class="nav-text">6.3 编码转换</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-字符串和整数"><span class="nav-number">7.</span> <span class="nav-text">7. 字符串和整数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-Redis存储效率"><span class="nav-number">8.</span> <span class="nav-text">8. Redis存储效率</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#8-1-字符串对象"><span class="nav-number">8.1.</span> <span class="nav-text">8.1 字符串对象</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-2-字典结点对象"><span class="nav-number">8.2.</span> <span class="nav-text">8.2 字典结点对象</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-3-存储效率"><span class="nav-number">8.3.</span> <span class="nav-text">8.3 存储效率</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2021</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Noahsark</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
    <span title="站点总字数">197k</span>
  

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    
    <span title="站点阅读时长">2:59</span>
  
</div>

<div class="BbeiAn-info">
    <a target="_blank" href="https://beian.miit.gov.cn/" rel="nofollow">粤ICP备 2021097726号-1 </a>
	<a target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=44030702004132" style="text-decoration:none;padding-left:30px;background:url(https://s1.ax1x.com/2018/09/29/ilmwIH.png) no-repeat left center" rel="nofollow">粤公网安备 44030702004132号</a>
</div>


  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v3.9.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> v6.5.0</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    
	
    

    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.5.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.5.0"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=6.5.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=6.5.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.5.0"></script>



  



  










  





  

  

  

  

  

  
  

  

  

  

  

  

  

</body>
</html>
